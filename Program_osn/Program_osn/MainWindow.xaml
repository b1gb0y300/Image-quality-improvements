<Window x:Class="ImageEnhancementWpf.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ImageUP — улучшение качества изображений"
        Height="650" Width="1100"
        WindowStartupLocation="CenterScreen">

    <Window.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#14141F" Offset="0"/>
            <GradientStop Color="#0E0E16" Offset="1"/>
        </LinearGradientBrush>
    </Window.Background>

    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3*"/>
            <ColumnDefinition Width="2*"/>
        </Grid.ColumnDefinitions>

        <Grid Grid.Column="0" Margin="0,0,10,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Border Background="{StaticResource CardBrush}"
                    CornerRadius="14"
                    Padding="10"
                    Effect="{StaticResource CardShadow}"
                    Margin="0,0,0,5">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Исходное изображение"
                               FontWeight="SemiBold"
                               Foreground="#E5E7EB"
                               Margin="2,0,0,4"/>

                    <Border Grid.Row="1"
                            Background="#15151F"
                            BorderBrush="#26263A"
                            BorderThickness="1"
                            CornerRadius="10"
                            ClipToBounds="True">
                        <Grid>
                            <Image x:Name="OriginalImageControl"
                                   Stretch="Uniform"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   RenderTransformOrigin="0.5,0.5"
                                   MouseLeftButtonDown="OriginalImageControl_MouseLeftButtonDown">
                                <Image.RenderTransform>
                                    <ScaleTransform x:Name="OriginalImageScale"
                                                    ScaleX="1" ScaleY="1"/>
                                </Image.RenderTransform>
                            </Image>
                        </Grid>
                    </Border>
                </Grid>
            </Border>

            <Border Background="{StaticResource CardBrush}"
                    CornerRadius="14"
                    Padding="10"
                    Effect="{StaticResource CardShadow}"
                    Grid.Row="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Обработанное изображение"
                               FontWeight="SemiBold"
                               Foreground="#E5E7EB"
                               Margin="2,0,0,4"/>

                    <Border Grid.Row="1"
                            Background="#15151F"
                            BorderBrush="#26263A"
                            BorderThickness="1"
                            CornerRadius="10"
                            ClipToBounds="True">
                        <Grid>
                            <Image x:Name="ProcessedImageControl"
                                   Stretch="Uniform"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   RenderTransformOrigin="0.5,0.5"
                                   MouseLeftButtonDown="ProcessedImageControl_MouseLeftButtonDown">
                                <Image.RenderTransform>
                                    <ScaleTransform x:Name="ProcessedImageScale"
                                                    ScaleX="1" ScaleY="1"/>
                                </Image.RenderTransform>
                            </Image>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
        </Grid>

        <Border Grid.Column="1"
                Background="{StaticResource DarkPanelBrush}"
                CornerRadius="18"
                Padding="16"
                Effect="{StaticResource CardShadow}">
            <StackPanel>

                <TextBlock Text="Панель управления"
                           FontSize="20"
                           FontWeight="Bold"
                           Foreground="White"
                           Margin="0,0,0,12"/>

                <StackPanel Orientation="Horizontal"
                            Margin="0,0,0,12">
                    <Button Content="Загрузить"
                            Width="120"
                            Margin="0,0,8,0"
                            Style="{StaticResource AccentButton}"
                            Click="LoadImage_Click"/>
                    <Button Content="Сохранить"
                            Width="120"
                            Style="{StaticResource GhostButton}"
                            Click="SaveImage_Click"/>
                </StackPanel>

                <Separator Margin="0,4"/>

                <TextBlock Text="Методы улучшения"
                           FontWeight="Bold"
                           Foreground="White"
                           Margin="0,6"/>

                <StackPanel>
                    <Button Content="Линейное контрастирование"
                            Margin="0,3"
                            Height="30"
                            Style="{StaticResource GhostButton}"
                            Click="LinearContrast_Click"/>

                    <Button Content="Эквализация гистограммы"
                            Margin="0,3"
                            Height="30"
                            Style="{StaticResource GhostButton}"
                            Click="HistogramEq_Click"/>

                    <Button Content="Медианный фильтр (3x3)"
                            Margin="0,3"
                            Height="30"
                            Style="{StaticResource GhostButton}"
                            Click="MedianFilter_Click"/>
                </StackPanel>

                <TextBlock Text="Фильтр Винера"
                           Foreground="White"
                           Margin="0,10,0,2"
                           FontWeight="Bold"/>

                <StackPanel Orientation="Horizontal"
                            VerticalAlignment="Center">
                    <TextBlock Text="Радиус окна:"
                               VerticalAlignment="Center"
                               Margin="0,0,5,0"
                               Foreground="#D1D5DB"/>
                    <Slider x:Name="WienerRadiusSlider"
                            Minimum="1"
                            Maximum="3"
                            Value="1"
                            Width="90"
                            TickFrequency="1"
                            IsSnapToTickEnabled="True"/>
                    <TextBlock Text="{Binding ElementName=WienerRadiusSlider, Path=Value}"
                               Foreground="#E5E7EB"
                               Margin="6,0,0,0"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal"
                            Margin="0,5,0,0">
                    <TextBlock Text="Дисперсия шума:"
                               VerticalAlignment="Center"
                               Margin="0,0,5,0"
                               Foreground="#D1D5DB"/>
                    <TextBox x:Name="NoiseVarianceTextBox"
                             Width="70"
                             Text="10"
                             Background="#111118"
                             Foreground="White"
                             BorderBrush="#374151"/>
                </StackPanel>

                <Button Content="Применить фильтр Винера"
                        Margin="0,6,0,12"
                        Height="32"
                        Style="{StaticResource AccentButton}"
                        Click="WienerFilter_Click"/>

                <Separator Margin="0,4"/>

                <TextBlock Text="Оценка качества (SSIM)"
                           FontWeight="Bold"
                           Foreground="White"
                           Margin="0,6"/>

                <StackPanel Orientation="Horizontal"
                            Margin="0,4">
                    <TextBlock Text="SSIM:"
                               VerticalAlignment="Center"
                               Margin="0,0,5,0"
                               Foreground="#D1D5DB"/>
                    <TextBlock x:Name="SsimValueTextBlock"
                               Foreground="#7CFC00"
                               FontWeight="Bold"
                               Text="—"/>
                </StackPanel>

                <TextBlock Text="SSIM рассчитывается между исходным и текущим обработанным изображением."
                           Foreground="#9CA3AF"
                           TextWrapping="Wrap"
                           FontSize="11"
                           Margin="0,8,0,0"/>

            </StackPanel>
        </Border>
    </Grid>
</Window>
